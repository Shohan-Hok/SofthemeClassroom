

<link href="~/Content/RoomTable/RoomTable.css" rel="stylesheet" />


<div id='wrap-table'>
    <div id="room-table">

        <img id="schema-image" src="~/Images/wallsMod.png" alt="" />
        <!--<img id="schema-image-b" src="~/Images/walls.png" alt="" /> -->

        <!--panel of properties-->
        <div id="prop-pane" data-request-url='@Url.Action("GetEquipmentDataForRoom", "Schedule")'>
            <div class="eq-container">
                <img class="eq-img" src="~/Images/icon-table.png" />
                <span class="table">12</span>
            </div>

            <div class="eq-container">
                <img class="eq-img" src="~/Images/icon-board.png" />
                <span class="board">12</span>
            </div>

            <div class="eq-container">
                <img class="eq-img" src="~/Images/icon-laptop.png" />
                <span class="laptop">12</span>
            </div>

            <div class="eq-container">
                <img class="eq-img" src="~/Images/icon-print.png" />
                <span class="printer">12</span>
            </div>

            <div class="eq-container">
                <img class="eq-img" src="~/Images/icon-proect.png" />
                <span class="projector">12</span>
            </div>
        </div>

        <!--Room containers-->
        <div class="room-container draggable resizeable" data-id="1" id="einstein">
            <span class="title-container">Einstein Classroom</span>
        </div>

        <div class="room-container draggable resizeable" data-id="2" id="empty">
            <span class="title-container">Einstein Classroom</span>
        </div>

        <div class="room-container draggable resizeable" data-id="3" id="english">
            <span class="title-container">Einstein Classroom</span>
        </div>

        <div class="room-container draggable resizeable" data-id="4" id="hr">
            <span class="title-container">Einstein Classroom</span>
        </div>

        <div class="room-container draggable resizeable" data-id="5" id="info">
            <span class="title-container">Einstein Classroom</span>
        </div>

        <div class="room-container draggable resizeable" data-id="6" id="newton">
            <span class="title-container">Einstein Classroom</span>
        </div>

        <div class="room-container draggable resizeable" data-id="7" id="tesla">
            <span class="title-container">Einstein Classroom</span>
        </div>

        <div class="room-container draggable resizeable" data-id="8" id="web-1">
            <span class="title-container">Einstein Classroom</span>
        </div>

        <div class="room-container draggable resizeable" data-id="9" id="web-2">
            <span class="title-container">Einstein Classroom</span>
        </div>

        <div class="room-container draggable resizeable" data-id="10" id="web-3">
            <span class="title-container">Einstein Classroom</span>
        </div>



        <!--Line details-->
        <div class="line-details draggable" data-id="1" id="einstein">
            <span class="caption">line-details-einstein</span>
            <img class="" src="~/Images/LineDetails/line-details-einstein.png">
        </div>

        <div class="line-details draggable" data-id="2" id="empty">
            <span class="caption">line-details-empty</span>
            <img class="" src="~/Images/LineDetails/line-details-empty.png">
        </div>

        <div class="line-details draggable" data-id="3" id="english">
            <span class="caption">line-details-english</span>
            <img class="" src="~/Images/LineDetails/line-details-english.png">
        </div>

        <div class="line-details draggable" id="hr" data-id="4">
            <span class="caption">line-details-hr</span>
            <img class="" src="~/Images/LineDetails/line-details-hr.png">
        </div>

        <div class="line-details draggable" data-id="5" id="info">
            <span class="caption">line-details-info</span>
            <img class="" src="~/Images/LineDetails/line-details-info.png">
        </div>

        <div class="line-details draggable" data-id="6" id="newton">
            <span class="caption">line-details-newton</span>
            <img class="" src="~/Images/LineDetails/line-details-newton.png">
        </div>

        <div class="line-details draggable" data-id="7" id="tesla">
            <span class="caption">line-details-tesla</span>
            <img class="" src="~/Images/LineDetails/line-details-tesla.png">
        </div>

        <div class="line-details draggable" data-id="8" id="web-1">
            <span class="caption">line-details-web-1</span>
            <img class="" src="~/Images/LineDetails/line-details-web-1.png">
        </div>

        <div class="line-details draggable" data-id="9" id="web-2">
            <span class="caption">line-details-web-2</span>
            <img class="" src="~/Images/LineDetails/line-details-web-2.png">
        </div>

        <div class="line-details draggable" data-id="10" id="web-3">
            <span class="caption">line-details-web-3</span>
            <img class="" src="~/Images/LineDetails/line-details-web-3.png">
        </div>

    </div>
</div>


<script>

    var resizeOptions = {
        autoHide: true, ghost: true
    }

    function renderRoomTable(timeNow)
    {
        

        $.ajax({
            url: '@Url.Action("GetRoomTableState", "Schedule")',
            type: "GET",
            context: this,
            data: { 'timeNow': timeNow.toISOString() },
            contentType: "application/json; charset=utf-8",
            success: function (data, textStatus, jqXHR) {
                //alert(JSON.stringify(data));

                var roomsAvail = data.roomsAvailability;
                for (var i = 0; i < roomsAvail.length; i++)
                {
                    var roomId = roomsAvail[i].RoomId;
                    var roomStatus = roomsAvail[i].Status;
                    var roomTitle = roomsAvail[i].RoomTitle;

                    var $roomElem = $('.room-container').filter(function () {
                        return $(this).data("id") == roomId
                    });

                    $roomElem.children('span').html(roomTitle);
                    $roomElem.removeClass('room-available room-booked room-disabled');

                    var cls = "";

                    if (roomStatus == 'available')
                        cls = 'room-available';
                    else if (roomStatus == 'booked')
                        cls = 'room-booked';
                    else if (roomStatus == 'disabled')
                        cls = 'room-disabled';

                    $roomElem.addClass(cls);
                }
            }
        });
    }

    $(() => {
        $(".draggable").draggable();

        $(".resizeable").resizable(resizeOptions);



        $('.room-container ').mouseover(function () {
            var id = $(this).attr('id');
            $('.line-details#' + id).css('display', 'inline-block');
            $('#prop-pane').css("visibility", "visible");
        });

        $('.room-container ').mouseout(function () {
            var id = $(this).attr('id');
            $('.line-details#' + id).css('display', 'none');
            $('#prop-pane').css("visibility", "hidden");
        });

        renderRoomTable(new Date());
    });
</script>